{"ast":null,"code":"var _jsxFileName = \"/home/lightmare/Documents/dev/web/tnp_plan/src/components/ProductionTable/ProductionTable.tsx\";\nimport React, { useState } from 'react';\nimport { InputField } from '../';\nimport './ProductionTable.css';\nexport const ProductionTable = props => {\n  const [month, setMonth] = useState(props.month);\n  const [remainToDo, setRemainToDo] = useState(0);\n  const [avg, setAvg] = useState(0);\n  const [avgWithPpr, setAvgWithPpr] = useState(0);\n  const [needsToDo, setNeedsToDo] = useState(0);\n\n  const onWorkDayChange = day => {\n    return amount => {\n      const m = { ...month\n      };\n      m.workDays[day].amount = +amount || 0;\n      setMonth(m);\n      remainToDoChanged(m);\n      avgChanged(m);\n      avgWithPprChanged(m);\n      onNeedsToDoChange(m);\n    };\n  };\n\n  const remainToDoChanged = m => {\n    let res = m.workDays.reduce((acc, d) => acc + d.amount, 0);\n    res = m.plan - res;\n    setRemainToDo(res > 0 ? res : 0);\n  };\n\n  const onPlanChange = p => {\n    const m = { ...month\n    };\n    m.plan = +p;\n    setMonth(m);\n    remainToDoChanged(m);\n  };\n\n  const avgChanged = m => {\n    let res = m.workDays.reduce((acc, d) => acc + d.amount, 0);\n    res = Math.floor(res / m.workDays.length);\n    setAvg(res);\n  };\n\n  const avgWithPprChanged = m => {\n    const avg = Math.floor(m.workDays.reduce((acc, d) => acc + d.amount, 0) / (m.workDays.length - m.ppr / 10));\n    setAvgWithPpr(avg);\n  };\n\n  const onPprChange = p => {\n    const m = { ...month\n    };\n    m.ppr = +p;\n    setMonth(m);\n  };\n\n  const onNeedsToDoChange = m => {\n    const alreadyDone = m.workDays.reduce((acc, d) => acc + d.amount, 0);\n    const res = m.plan - (m.plan - (m.plan - alreadyDone / (m.days - m.workDays.length)));\n    setNeedsToDo(res);\n  };\n\n  return /*#__PURE__*/React.createElement(\"table\", {\n    className: \"production-table\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"thead\", {\n    className: \"production-table__thead\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"tr\", {\n    className: \"production-table__tr\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"th\", {\n    className: \"production-table__td\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 11\n    }\n  }, \"\\u041F\\u043B\\u0430\\u043D\"), /*#__PURE__*/React.createElement(\"th\", {\n    className: \"production-table__td\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 11\n    }\n  }, \"\\u041E\\u0441\\u0442\\u0430\\u0442\\u043E\\u043A\")), /*#__PURE__*/React.createElement(\"tr\", {\n    className: \"production-table__tr\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"td\", {\n    className: \"production-table__td\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(InputField, {\n    type: 'text',\n    value: String(month.plan),\n    changed: onPlanChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(\"td\", {\n    className: \"production-table__td\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(InputField, {\n    type: 'text',\n    value: String(remainToDo),\n    disabled: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 13\n    }\n  }))), /*#__PURE__*/React.createElement(\"tr\", {\n    className: \"production-table__tr\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"th\", {\n    className: \"production-table__td\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 11\n    }\n  }, \"\\u041A\\u043E\\u044D\\u0444\\u0444\\u0438\\u0446\\u0438\\u0435\\u043D\\u0442\"), /*#__PURE__*/React.createElement(\"th\", {\n    className: \"production-table__td\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 11\n    }\n  }, \"\\u0421\\u0440\\u0435\\u0434\\u043D\\u0435\\u0435 \\u0432 \\u0441\\u043C\\u0435\\u043D\\u0443\")), /*#__PURE__*/React.createElement(\"tr\", {\n    className: \"production-table__tr\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"td\", {\n    className: \"production-table__td\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(InputField, {\n    type: 'text',\n    value: \"1.1\",\n    disabled: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(\"td\", {\n    className: \"production-table__td\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(InputField, {\n    type: 'text',\n    value: String(avg),\n    disabled: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 13\n    }\n  }))), /*#__PURE__*/React.createElement(\"tr\", {\n    className: \"production-table__tr\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"th\", {\n    className: \"production-table__td\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 11\n    }\n  }, \"\\u0427\\u0430\\u0441\\u044B \\u041F\\u041F\\u0420\"), /*#__PURE__*/React.createElement(\"th\", {\n    className: \"production-table__td\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 11\n    }\n  }, \"\\u0421\\u0440\\u0435\\u0434\\u043D\\u0435\\u0435 \\u0441 \\u041F\\u041F\\u0420\")), /*#__PURE__*/React.createElement(\"tr\", {\n    className: \"production-table__tr\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"td\", {\n    className: \"production-table__td\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(InputField, {\n    type: 'text',\n    value: String(month.ppr),\n    changed: onPprChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(\"td\", {\n    className: \"production-table__td\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(InputField, {\n    type: 'text',\n    value: String(avgWithPpr),\n    disabled: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 13\n    }\n  }))), /*#__PURE__*/React.createElement(\"tr\", {\n    className: \"production-table__tr\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"th\", {\n    className: \"production-table__td\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 11\n    }\n  }, \"\\u0421\\u043C\\u0435\\u043D\\u0430\"), /*#__PURE__*/React.createElement(\"th\", {\n    className: \"production-table__td\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 11\n    }\n  }, \"\\u041A\\u043E\\u043B\\u0438\\u0447\\u0435\\u0441\\u0442\\u0432\\u043E\"))), /*#__PURE__*/React.createElement(\"tbody\", {\n    className: \"production-table_tbody\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 7\n    }\n  }, month.workDays.map(workDay => {\n    return /*#__PURE__*/React.createElement(\"tr\", {\n      key: workDay.day,\n      className: \"production-table__tr\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"td\", {\n      className: \"production-table__td\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 18\n      }\n    }, /*#__PURE__*/React.createElement(InputField, {\n      type: 'text',\n      value: String(workDay.day + 1),\n      disabled: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 21\n      }\n    })), /*#__PURE__*/React.createElement(\"td\", {\n      className: \"production-table__td\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 18\n      }\n    }, /*#__PURE__*/React.createElement(InputField, {\n      type: 'text',\n      value: String(workDay.amount),\n      changed: onWorkDayChange(workDay.day),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 21\n      }\n    })));\n  })), /*#__PURE__*/React.createElement(\"tfoot\", {\n    className: \"production-table__tfoot\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"tr\", {\n    className: \"production-table__tr\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"th\", {\n    className: \"production-table__td\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 11\n    }\n  }, \"\\u0414\\u043B\\u044F \\u0432\\u044B\\u043F\\u043E\\u043B\\u043D\\u0435\\u043D\\u0438\\u044F \\u043F\\u043B\\u0430\\u043D\\u0430 \\u043D\\u0443\\u0436\\u043D\\u043E \\u0434\\u0435\\u043B\\u0430\\u0442\\u044C \\u043F\\u043E:\"), /*#__PURE__*/React.createElement(\"th\", {\n    className: \"production-table__td\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(InputField, {\n    type: 'text',\n    value: String(needsToDo),\n    disabled: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 48\n    }\n  })))));\n};","map":{"version":3,"sources":["/home/lightmare/Documents/dev/web/tnp_plan/src/components/ProductionTable/ProductionTable.tsx"],"names":["React","useState","InputField","ProductionTable","props","month","setMonth","remainToDo","setRemainToDo","avg","setAvg","avgWithPpr","setAvgWithPpr","needsToDo","setNeedsToDo","onWorkDayChange","day","amount","m","workDays","remainToDoChanged","avgChanged","avgWithPprChanged","onNeedsToDoChange","res","reduce","acc","d","plan","onPlanChange","p","Math","floor","length","ppr","onPprChange","alreadyDone","days","String","map","workDay"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\n\nimport { InputField } from '../';\n\nimport './ProductionTable.css';\n\nimport { WorkMonth, WorkDay } from '../../models';\n\ninterface Props {\n  month: WorkMonth;\n}\n\nexport const ProductionTable = (props: Props) => {\n  const [month, setMonth] = useState(props.month);\n  const [remainToDo, setRemainToDo] = useState(0);\n  const [avg, setAvg] = useState(0);\n  const [avgWithPpr, setAvgWithPpr] = useState(0);\n  const [needsToDo, setNeedsToDo] = useState(0);\n\n  const onWorkDayChange = (day: number) => {\n    return (amount: string) => {\n      const m = {...month};\n      m.workDays[day].amount = + amount || 0;\n      setMonth(m);\n      remainToDoChanged(m);\n      avgChanged(m);\n      avgWithPprChanged(m);\n      onNeedsToDoChange(m);\n    }\n  }\n\n  const remainToDoChanged = (m: WorkMonth) => {\n    let res = m.workDays.reduce((acc, d) => acc + d.amount, 0);\n    res = m.plan - res;\n    setRemainToDo(res > 0 ? res : 0);\n  }\n\n  const onPlanChange = (p: string) => {\n    const m = {...month};\n    m.plan = + p;\n    setMonth(m);\n    remainToDoChanged(m);\n  }\n\n  const avgChanged = (m: WorkMonth) => {\n    let res = m.workDays.reduce((acc, d) => acc + d.amount, 0);\n    res = Math.floor(res / m.workDays.length);\n    setAvg(res);\n  }\n\n  const avgWithPprChanged = (m: WorkMonth) => {\n    const avg = Math.floor(\n      m.workDays.reduce((acc, d) => acc + d.amount, 0) / (m.workDays.length - m.ppr / 10),\n    );\n    setAvgWithPpr(avg);\n  }\n\n  const onPprChange = (p: string) => {\n    const m = {...month};\n    m.ppr = + p;\n    setMonth(m);\n  }\n\n  const onNeedsToDoChange = (m: WorkMonth) => {\n    const alreadyDone = m.workDays.reduce((acc, d) => acc + d.amount, 0);\n    const res = m.plan - (m.plan - (m.plan - alreadyDone / (m.days - m.workDays.length)));\n    setNeedsToDo(res);\n  }\n\n\treturn (\n    <table className=\"production-table\">\n      <thead className=\"production-table__thead\">\n        <tr className=\"production-table__tr\">\n          <th className=\"production-table__td\">План</th>\n          <th className=\"production-table__td\">Остаток</th>\n        </tr>\n        <tr className=\"production-table__tr\">\n          <td className=\"production-table__td\">\n            <InputField type={'text'} value={String(month.plan)} changed={onPlanChange}/>\n          </td>\n          <td className=\"production-table__td\">\n            <InputField type={'text'} value={String(remainToDo)} disabled={true}/>\n          </td>\n        </tr>\n        <tr className=\"production-table__tr\">\n          <th className=\"production-table__td\">Коэффициент</th>\n          <th className=\"production-table__td\">Среднее в смену</th>\n        </tr>\n        <tr className=\"production-table__tr\">\n          <td className=\"production-table__td\">\n            <InputField type={'text'} value={\"1.1\"} disabled={true}/>\n          </td>\n          <td className=\"production-table__td\">\n            <InputField type={'text'} value={String(avg)} disabled={true}/>\n          </td>\n        </tr>\n        <tr className=\"production-table__tr\">\n          <th className=\"production-table__td\">Часы ППР</th>\n          <th className=\"production-table__td\">Среднее с ППР</th>\n        </tr>\n        <tr className=\"production-table__tr\">\n          <td className=\"production-table__td\">\n            <InputField type={'text'} value={String(month.ppr)} changed={onPprChange}/>\n          </td>\n          <td className=\"production-table__td\">\n            <InputField type={'text'} value={String(avgWithPpr)} disabled={true}/>\n          </td>\n        </tr>\n        <tr className=\"production-table__tr\">\n          <th className=\"production-table__td\">Смена</th>\n          <th className=\"production-table__td\">Количество</th>\n        </tr>\n      </thead>\n      <tbody className=\"production-table_tbody\">\n          { month.workDays.map((workDay) => {\n              return (\n                <tr key={workDay.day} className=\"production-table__tr\">\n                 <td className=\"production-table__td\">\n                    <InputField type={'text'} value={String(workDay.day + 1)} disabled={true}/>\n                 </td>\n                 <td className=\"production-table__td\">\n                    <InputField type={'text'} value={String(workDay.amount)} changed={onWorkDayChange(workDay.day)}/>\n                 </td>\n                </tr>\n              )\n            })\n          }\n      </tbody>\n      <tfoot className=\"production-table__tfoot\">\n        <tr className=\"production-table__tr\">\n          <th className=\"production-table__td\">Для выполнения плана нужно делать по:</th>\n          <th className=\"production-table__td\"><InputField type={'text'} value={String(needsToDo)} disabled={true}/></th>\n        </tr>\n      </tfoot>\n    </table>\n  )\n}\n"]},"metadata":{},"sourceType":"module"}