{"ast":null,"code":"var _jsxFileName = \"/home/lightmare/Documents/dev/web/tnp_plan/client/src/pages/ProductionPage.tsx\";\nimport React, { useState, useEffect, useContext } from 'react';\nimport { Link, useParams } from 'react-router-dom';\nimport { ErrorBoundary, NewMonthForm, NewWorkDayForm } from '../components';\nimport { Button, CircularProgress, SwipeableDrawer, List, ListItem, ListItemText, Divider, Dialog } from '@material-ui/core/';\nimport { DBServiceContext } from '../App';\nimport './ProductionPage.css';\nexport const ProductionPage = () => {\n  const {\n    product\n  } = useParams();\n  const dbService = useContext(DBServiceContext);\n  const [month, setMonth] = useState({\n    product,\n    days: 0,\n    plan: 0,\n    ppr: 0,\n    workDays: []\n  });\n  const [isLoading, setIsLoading] = useState(true);\n  const [menuIsOpened, setMenuIsOpened] = useState(false);\n  const [newMonthMenuOpened, setNewMonthMenuOpened] = useState(false);\n  const [newWorkDayMenuOpened, setNewWorkDayMenuOpened] = useState(false);\n  const [changeMonthModalOpened, setChangeMonthModalOpened] = useState(false);\n  useEffect(() => {\n    (async () => {\n      try {\n        const m = await dbService.getMonth(product);\n        setMonth(m);\n      } catch (e) {} finally {\n        setIsLoading(false);\n      }\n    })();\n  }, []);\n\n  const onMenuToggle = () => {\n    setMenuIsOpened(!isLoading);\n  };\n\n  const onCloseMenu = () => {\n    setMenuIsOpened(false);\n  };\n\n  const onNewMonthClick = () => {\n    setNewMonthMenuOpened(true);\n    setMenuIsOpened(false);\n  };\n\n  const onNewMonthConfirmed = m => {\n    (async () => {\n      try {\n        setIsLoading(true);\n        await dbService.addNewMonth(product, m.plan, m.days, m.ppr);\n        setMonth(m);\n      } catch (e) {\n        console.log(e.message);\n      } finally {\n        setIsLoading(false);\n        closeNewMonthMenu();\n      }\n    })();\n  };\n\n  const onNewMonthCanceled = () => {\n    closeNewMonthMenu();\n  };\n\n  const closeNewMonthMenu = () => {\n    setNewMonthMenuOpened(false);\n  };\n\n  const onNewWorkDayClick = () => {\n    setNewWorkDayMenuOpened(true);\n    setMenuIsOpened(false);\n  };\n\n  const closeNewWorkDayMenu = () => {\n    setNewWorkDayMenuOpened(false);\n  };\n\n  const onNewWorkDayCanceled = () => {\n    setNewWorkDayMenuOpened(false);\n  };\n\n  const onNewWorkDayConfirmed = amount => {\n    (async () => {\n      try {\n        setIsLoading(true);\n        debugger;\n        const newMonth = { ...month\n        };\n        const day = newMonth.workDays.length;\n        newMonth.workDays.push({\n          day,\n          amount\n        });\n        await dbService.addWorkDay(product, day, amount);\n        setMonth(newMonth);\n      } catch (e) {\n        console.log(e.message);\n      } finally {\n        setIsLoading(false);\n        setNewWorkDayMenuOpened(false);\n      }\n    })();\n  };\n\n  const onChangeWorkkDayClick = () => {\n    console.log('onChangeWorkkDayClick');\n    setMenuIsOpened(false);\n  };\n\n  const onChangePlanClick = () => {\n    console.log('onChangePlanClick');\n    setMenuIsOpened(false);\n  };\n\n  const onChangePprClick = () => {\n    console.log('onChangePprClick');\n    setMenuIsOpened(false);\n  };\n\n  if (isLoading) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"production-page__spinner-container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 146,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(CircularProgress, {\n      size: \"12rem\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 147,\n        columnNumber: 7\n      }\n    }));\n  }\n\n  return /*#__PURE__*/React.createElement(ErrorBoundary, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"nav\", {\n    className: \"production-page__nav-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Link, {\n    className: \"production-page__link\",\n    to: \"/\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    variant: \"outlined\",\n    color: \"secondary\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 11\n    }\n  }, \"\\u041D\\u0430\\u0437\\u0430\\u0434\")), /*#__PURE__*/React.createElement(Button, {\n    variant: \"outlined\",\n    color: \"primary\",\n    onClick: onMenuToggle,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160,\n      columnNumber: 9\n    }\n  }, \"\\u0423\\u043F\\u0440\\u0430\\u0432\\u043B\\u0435\\u043D\\u0438\\u0435\")), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 7\n    }\n  }, month.plan), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 165,\n      columnNumber: 7\n    }\n  }, month.days), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 7\n    }\n  }, month.ppr), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167,\n      columnNumber: 7\n    }\n  }, month.workDays[0]), /*#__PURE__*/React.createElement(SwipeableDrawer, {\n    anchor: 'bottom',\n    open: menuIsOpened,\n    onClose: onCloseMenu,\n    onOpen: onMenuToggle,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(List, {\n    \"aria-label\": \"menu\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(ListItem, {\n    button: true,\n    onClick: onNewMonthClick,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 176,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(ListItemText, {\n    className: \"production-page__item-text\",\n    inset: true,\n    primary: \"\\u041D\\u043E\\u0432\\u044B\\u0439 \\u043C\\u0435\\u0441\\u044F\\u0446\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(Divider, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(ListItem, {\n    button: true,\n    onClick: onNewWorkDayClick,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(ListItemText, {\n    className: \"production-page__item-text\",\n    inset: true,\n    primary: \"\\u041D\\u043E\\u0432\\u0430\\u044F \\u0441\\u043C\\u0435\\u043D\\u0430\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 183,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(Divider, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 186,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(ListItem, {\n    button: true,\n    onClick: onChangeWorkkDayClick,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 188,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(ListItemText, {\n    className: \"production-page__item-text\",\n    inset: true,\n    primary: \"\\u0418\\u0437\\u043C\\u0435\\u043D\\u0438\\u0442\\u044C \\u0441\\u043C\\u0435\\u043D\\u0443\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 189,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(Divider, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(ListItem, {\n    button: true,\n    onClick: onChangePlanClick,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 194,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(ListItemText, {\n    className: \"production-page__item-text\",\n    inset: true,\n    primary: \"\\u0418\\u0437\\u043C\\u0435\\u043D\\u0438\\u0442\\u044C \\u043F\\u043B\\u0430\\u043D\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 195,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(Divider, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 198,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(ListItem, {\n    button: true,\n    onClick: onChangePprClick,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 200,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(ListItemText, {\n    className: \"production-page__item-text\",\n    inset: true,\n    primary: \"\\u0418\\u0437\\u043C\\u0435\\u043D\\u0438\\u0442\\u044C \\u0447\\u0430\\u0441\\u044B \\u041F\\u041F\\u0420\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 201,\n      columnNumber: 13\n    }\n  })))), /*#__PURE__*/React.createElement(Dialog, {\n    open: newMonthMenuOpened,\n    onClose: closeNewMonthMenu,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 206,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(NewMonthForm, {\n    confirmed: onNewMonthConfirmed,\n    canceled: onNewMonthCanceled,\n    product: product,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 207,\n      columnNumber: 9\n    }\n  })), /*#__PURE__*/React.createElement(Dialog, {\n    open: newWorkDayMenuOpened,\n    onClose: closeNewWorkDayMenu,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 210,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(NewWorkDayForm, {\n    confirmed: onNewWorkDayConfirmed,\n    canceled: onNewWorkDayCanceled,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 211,\n      columnNumber: 9\n    }\n  })));\n};","map":{"version":3,"sources":["/home/lightmare/Documents/dev/web/tnp_plan/client/src/pages/ProductionPage.tsx"],"names":["React","useState","useEffect","useContext","Link","useParams","ErrorBoundary","NewMonthForm","NewWorkDayForm","Button","CircularProgress","SwipeableDrawer","List","ListItem","ListItemText","Divider","Dialog","DBServiceContext","ProductionPage","product","dbService","month","setMonth","days","plan","ppr","workDays","isLoading","setIsLoading","menuIsOpened","setMenuIsOpened","newMonthMenuOpened","setNewMonthMenuOpened","newWorkDayMenuOpened","setNewWorkDayMenuOpened","changeMonthModalOpened","setChangeMonthModalOpened","m","getMonth","e","onMenuToggle","onCloseMenu","onNewMonthClick","onNewMonthConfirmed","addNewMonth","console","log","message","closeNewMonthMenu","onNewMonthCanceled","onNewWorkDayClick","closeNewWorkDayMenu","onNewWorkDayCanceled","onNewWorkDayConfirmed","amount","newMonth","day","length","push","addWorkDay","onChangeWorkkDayClick","onChangePlanClick","onChangePprClick"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,SAA1B,EAAqCC,UAArC,QAAuD,OAAvD;AACA,SAASC,IAAT,EAAeC,SAAf,QAAgC,kBAAhC;AAEA,SACEC,aADF,EAEEC,YAFF,EAGEC,cAHF,QAIO,eAJP;AAKA,SACEC,MADF,EAEEC,gBAFF,EAGEC,eAHF,EAIEC,IAJF,EAKEC,QALF,EAMEC,YANF,EAOEC,OAPF,EAQEC,MARF,QASO,oBATP;AAWA,SAASC,gBAAT,QAAiC,QAAjC;AAEA,OAAO,sBAAP;AAGA,OAAO,MAAMC,cAAc,GAAG,MAAM;AAClC,QAAM;AAACC,IAAAA;AAAD,MAAYd,SAAS,EAA3B;AACA,QAAMe,SAAS,GAAGjB,UAAU,CAACc,gBAAD,CAA5B;AAEA,QAAM,CAACI,KAAD,EAAQC,QAAR,IAAoBrB,QAAQ,CAAC;AACjCkB,IAAAA,OADiC;AAEjCI,IAAAA,IAAI,EAAE,CAF2B;AAGjCC,IAAAA,IAAI,EAAE,CAH2B;AAIjCC,IAAAA,GAAG,EAAE,CAJ4B;AAKjCC,IAAAA,QAAQ,EAAE;AALuB,GAAD,CAAlC;AAOA,QAAM,CAACC,SAAD,EAAYC,YAAZ,IAA4B3B,QAAQ,CAAC,IAAD,CAA1C;AACA,QAAM,CAAC4B,YAAD,EAAeC,eAAf,IAAkC7B,QAAQ,CAAC,KAAD,CAAhD;AACA,QAAM,CAAC8B,kBAAD,EAAqBC,qBAArB,IAA8C/B,QAAQ,CAAC,KAAD,CAA5D;AACA,QAAM,CAACgC,oBAAD,EAAuBC,uBAAvB,IAAkDjC,QAAQ,CAAC,KAAD,CAAhE;AACA,QAAM,CAACkC,sBAAD,EAAyBC,yBAAzB,IAAsDnC,QAAQ,CAAC,KAAD,CAApE;AAEAC,EAAAA,SAAS,CAAC,MAAM;AACd,KAAC,YAAY;AACX,UAAI;AACF,cAAMmC,CAAC,GAAG,MAAMjB,SAAS,CAACkB,QAAV,CAAmBnB,OAAnB,CAAhB;AACAG,QAAAA,QAAQ,CAACe,CAAD,CAAR;AACD,OAHD,CAGE,OAAME,CAAN,EAAS,CAEV,CALD,SAKU;AACRX,QAAAA,YAAY,CAAC,KAAD,CAAZ;AACD;AACF,KATD;AAUD,GAXQ,EAWN,EAXM,CAAT;;AAaA,QAAMY,YAAY,GAAG,MAAM;AACzBV,IAAAA,eAAe,CAAC,CAACH,SAAF,CAAf;AACD,GAFD;;AAIA,QAAMc,WAAW,GAAG,MAAM;AACxBX,IAAAA,eAAe,CAAC,KAAD,CAAf;AACD,GAFD;;AAKA,QAAMY,eAAe,GAAG,MAAM;AAC5BV,IAAAA,qBAAqB,CAAC,IAAD,CAArB;AACAF,IAAAA,eAAe,CAAC,KAAD,CAAf;AACD,GAHD;;AAKA,QAAMa,mBAAmB,GAAIN,CAAD,IAAkB;AAC5C,KAAC,YAAY;AACX,UAAI;AACFT,QAAAA,YAAY,CAAC,IAAD,CAAZ;AACA,cAAMR,SAAS,CAACwB,WAAV,CAAsBzB,OAAtB,EAA+BkB,CAAC,CAACb,IAAjC,EAAuCa,CAAC,CAACd,IAAzC,EAA+Cc,CAAC,CAACZ,GAAjD,CAAN;AACAH,QAAAA,QAAQ,CAACe,CAAD,CAAR;AACD,OAJD,CAIE,OAAME,CAAN,EAAS;AACTM,QAAAA,OAAO,CAACC,GAAR,CAAYP,CAAC,CAACQ,OAAd;AACD,OAND,SAMU;AACRnB,QAAAA,YAAY,CAAC,KAAD,CAAZ;AACAoB,QAAAA,iBAAiB;AAClB;AACF,KAXD;AAYD,GAbD;;AAeA,QAAMC,kBAAkB,GAAG,MAAM;AAC/BD,IAAAA,iBAAiB;AAClB,GAFD;;AAIA,QAAMA,iBAAiB,GAAG,MAAM;AAC9BhB,IAAAA,qBAAqB,CAAC,KAAD,CAArB;AACD,GAFD;;AAOA,QAAMkB,iBAAiB,GAAG,MAAM;AAC9BhB,IAAAA,uBAAuB,CAAC,IAAD,CAAvB;AACAJ,IAAAA,eAAe,CAAC,KAAD,CAAf;AACD,GAHD;;AAKA,QAAMqB,mBAAmB,GAAG,MAAM;AAChCjB,IAAAA,uBAAuB,CAAC,KAAD,CAAvB;AACD,GAFD;;AAIA,QAAMkB,oBAAoB,GAAG,MAAM;AACjClB,IAAAA,uBAAuB,CAAC,KAAD,CAAvB;AACD,GAFD;;AAIA,QAAMmB,qBAAqB,GAAIC,MAAD,IAAoB;AAChD,KAAC,YAAY;AACX,UAAI;AACF1B,QAAAA,YAAY,CAAC,IAAD,CAAZ;AACA;AACA,cAAM2B,QAAQ,GAAG,EAAC,GAAGlC;AAAJ,SAAjB;AACA,cAAMmC,GAAG,GAAGD,QAAQ,CAAC7B,QAAT,CAAkB+B,MAA9B;AACAF,QAAAA,QAAQ,CAAC7B,QAAT,CAAkBgC,IAAlB,CAAuB;AAACF,UAAAA,GAAD;AAAMF,UAAAA;AAAN,SAAvB;AACA,cAAMlC,SAAS,CAACuC,UAAV,CAAqBxC,OAArB,EAA8BqC,GAA9B,EAAmCF,MAAnC,CAAN;AACAhC,QAAAA,QAAQ,CAACiC,QAAD,CAAR;AACD,OARD,CAQE,OAAMhB,CAAN,EAAS;AACTM,QAAAA,OAAO,CAACC,GAAR,CAAYP,CAAC,CAACQ,OAAd;AACD,OAVD,SAUU;AACRnB,QAAAA,YAAY,CAAC,KAAD,CAAZ;AACAM,QAAAA,uBAAuB,CAAC,KAAD,CAAvB;AACD;AACF,KAfD;AAgBD,GAjBD;;AAqBA,QAAM0B,qBAAqB,GAAG,MAAM;AAClCf,IAAAA,OAAO,CAACC,GAAR,CAAY,uBAAZ;AACAhB,IAAAA,eAAe,CAAC,KAAD,CAAf;AACD,GAHD;;AAKA,QAAM+B,iBAAiB,GAAG,MAAM;AAC9BhB,IAAAA,OAAO,CAACC,GAAR,CAAY,mBAAZ;AACAhB,IAAAA,eAAe,CAAC,KAAD,CAAf;AACD,GAHD;;AAKA,QAAMgC,gBAAgB,GAAG,MAAM;AAC7BjB,IAAAA,OAAO,CAACC,GAAR,CAAY,kBAAZ;AACAhB,IAAAA,eAAe,CAAC,KAAD,CAAf;AACD,GAHD;;AAKA,MAAIH,SAAJ,EAAe;AACb,wBACE;AAAK,MAAA,SAAS,EAAC,oCAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACA,oBAAC,gBAAD;AAAkB,MAAA,IAAI,EAAE,OAAxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADA,CADF;AAKD;;AAED,sBACE,oBAAC,aAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAK,IAAA,SAAS,EAAC,gCAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,IAAD;AAAM,IAAA,SAAS,EAAC,uBAAhB;AAAwC,IAAA,EAAE,EAAC,GAA3C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,MAAD;AAAQ,IAAA,OAAO,EAAC,UAAhB;AAA2B,IAAA,KAAK,EAAC,WAAjC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sCADF,CADF,eAME,oBAAC,MAAD;AAAQ,IAAA,OAAO,EAAC,UAAhB;AAA2B,IAAA,KAAK,EAAC,SAAjC;AAA2C,IAAA,OAAO,EAAEa,YAApD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oEANF,CADF,eAWE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAInB,KAAK,CAACG,IAAV,CAXF,eAYE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAIH,KAAK,CAACE,IAAV,CAZF,eAaE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAIF,KAAK,CAACI,GAAV,CAbF,eAcE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAIJ,KAAK,CAACK,QAAN,CAAe,CAAf,CAAJ,CAdF,eAgBA,oBAAC,eAAD;AACE,IAAA,MAAM,EAAE,QADV;AAEE,IAAA,IAAI,EAAEG,YAFR;AAGE,IAAA,OAAO,EAAEY,WAHX;AAIE,IAAA,MAAM,EAAED,YAJV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAMI,oBAAC,IAAD;AAAM,kBAAW,MAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,QAAD;AAAU,IAAA,MAAM,MAAhB;AAAiB,IAAA,OAAO,EAAEE,eAA1B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,YAAD;AAAc,IAAA,SAAS,EAAC,4BAAxB;AAAqD,IAAA,KAAK,MAA1D;AAA2D,IAAA,OAAO,EAAC,+DAAnE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,CADF,eAKE,oBAAC,OAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IALF,eAOE,oBAAC,QAAD;AAAU,IAAA,MAAM,MAAhB;AAAiB,IAAA,OAAO,EAAEQ,iBAA1B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,YAAD;AAAc,IAAA,SAAS,EAAC,4BAAxB;AAAqD,IAAA,KAAK,MAA1D;AAA2D,IAAA,OAAO,EAAC,+DAAnE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,CAPF,eAWE,oBAAC,OAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAXF,eAaE,oBAAC,QAAD;AAAU,IAAA,MAAM,MAAhB;AAAiB,IAAA,OAAO,EAAEU,qBAA1B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,YAAD;AAAc,IAAA,SAAS,EAAC,4BAAxB;AAAqD,IAAA,KAAK,MAA1D;AAA2D,IAAA,OAAO,EAAC,iFAAnE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,CAbF,eAiBE,oBAAC,OAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAjBF,eAmBE,oBAAC,QAAD;AAAU,IAAA,MAAM,MAAhB;AAAiB,IAAA,OAAO,EAAEC,iBAA1B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,YAAD;AAAc,IAAA,SAAS,EAAC,4BAAxB;AAAqD,IAAA,KAAK,MAA1D;AAA2D,IAAA,OAAO,EAAC,2EAAnE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,CAnBF,eAuBE,oBAAC,OAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAvBF,eAyBE,oBAAC,QAAD;AAAU,IAAA,MAAM,MAAhB;AAAiB,IAAA,OAAO,EAAEC,gBAA1B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,YAAD;AAAc,IAAA,SAAS,EAAC,4BAAxB;AAAqD,IAAA,KAAK,MAA1D;AAA2D,IAAA,OAAO,EAAC,8FAAnE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,CAzBF,CANJ,CAhBA,eAqDE,oBAAC,MAAD;AAAQ,IAAA,IAAI,EAAE/B,kBAAd;AAAkC,IAAA,OAAO,EAAEiB,iBAA3C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,YAAD;AAAc,IAAA,SAAS,EAAEL,mBAAzB;AAA8C,IAAA,QAAQ,EAAEM,kBAAxD;AAA4E,IAAA,OAAO,EAAE9B,OAArF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,CArDF,eAyDE,oBAAC,MAAD;AAAQ,IAAA,IAAI,EAAEc,oBAAd;AAAoC,IAAA,OAAO,EAAEkB,mBAA7C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,cAAD;AAAgB,IAAA,SAAS,EAAEE,qBAA3B;AAAkD,IAAA,QAAQ,EAAED,oBAA5D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,CAzDF,CADF;AA+DD,CA9LM","sourcesContent":["import React, { useState, useEffect, useContext } from 'react';\nimport { Link, useParams } from 'react-router-dom';\n\nimport { \n  ErrorBoundary, \n  NewMonthForm, \n  NewWorkDayForm \n} from '../components';\nimport { \n  Button, \n  CircularProgress, \n  SwipeableDrawer,\n  List,\n  ListItem,\n  ListItemText,\n  Divider,\n  Dialog\n} from '@material-ui/core/';\n\nimport { DBServiceContext } from '../App';\nimport { WorkMonth, Products } from '../models';\nimport './ProductionPage.css';\n\n\nexport const ProductionPage = () => {\n  const {product} = useParams();\n  const dbService = useContext(DBServiceContext);\n\n  const [month, setMonth] = useState({\n    product,\n    days: 0,\n    plan: 0,\n    ppr: 0,\n    workDays: []\n  } as WorkMonth);\n  const [isLoading, setIsLoading] = useState(true);\n  const [menuIsOpened, setMenuIsOpened] = useState(false);\n  const [newMonthMenuOpened, setNewMonthMenuOpened] = useState(false);\n  const [newWorkDayMenuOpened, setNewWorkDayMenuOpened] = useState(false);\n  const [changeMonthModalOpened, setChangeMonthModalOpened] = useState(false);\n\n  useEffect(() => {\n    (async () => {\n      try {\n        const m = await dbService.getMonth(product);\n        setMonth(m);\n      } catch(e) {\n\n      } finally {\n        setIsLoading(false);\n      }\n    })();\n  }, []);\n\n  const onMenuToggle = () => {\n    setMenuIsOpened(!isLoading);\n  }\n\n  const onCloseMenu = () => {\n    setMenuIsOpened(false);\n  }\n\n\n  const onNewMonthClick = () => {\n    setNewMonthMenuOpened(true);\n    setMenuIsOpened(false);\n  }\n\n  const onNewMonthConfirmed = (m: WorkMonth) => {\n    (async () => {\n      try {\n        setIsLoading(true);\n        await dbService.addNewMonth(product, m.plan, m.days, m.ppr);\n        setMonth(m);\n      } catch(e) {\n        console.log(e.message);\n      } finally {\n        setIsLoading(false);\n        closeNewMonthMenu();\n      }\n    })();\n  }\n\n  const onNewMonthCanceled = () => {\n    closeNewMonthMenu();\n  }\n\n  const closeNewMonthMenu = () => {\n    setNewMonthMenuOpened(false);\n  }\n\n\n\n\n  const onNewWorkDayClick = () => {\n    setNewWorkDayMenuOpened(true);\n    setMenuIsOpened(false);\n  }\n\n  const closeNewWorkDayMenu = () => {\n    setNewWorkDayMenuOpened(false);\n  }\n\n  const onNewWorkDayCanceled = () => {\n    setNewWorkDayMenuOpened(false);\n  }\n\n  const onNewWorkDayConfirmed = (amount: number) => {\n    (async () => {\n      try {\n        setIsLoading(true);\n        debugger\n        const newMonth = {...month};\n        const day = newMonth.workDays.length;\n        newMonth.workDays.push({day, amount});\n        await dbService.addWorkDay(product, day, amount);\n        setMonth(newMonth);\n      } catch(e) {\n        console.log(e.message);\n      } finally {\n        setIsLoading(false);\n        setNewWorkDayMenuOpened(false);\n      }\n    })();\n  }\n\n\n\n  const onChangeWorkkDayClick = () => {\n    console.log('onChangeWorkkDayClick')\n    setMenuIsOpened(false);\n  }\n\n  const onChangePlanClick = () => {\n    console.log('onChangePlanClick')\n    setMenuIsOpened(false);\n  }\n\n  const onChangePprClick = () => {\n    console.log('onChangePprClick')\n    setMenuIsOpened(false);\n  }\n\n  if (isLoading) {\n    return (\n      <div className=\"production-page__spinner-container\">\n      <CircularProgress size={\"12rem\"} />\n      </div> \n      )\n  }\n\n  return (\n    <ErrorBoundary>\n      <nav className=\"production-page__nav-container\">\n        <Link className=\"production-page__link\" to=\"/\">\n          <Button variant=\"outlined\" color=\"secondary\">\n            Назад \n          </Button>\n        </Link>\n        <Button variant=\"outlined\" color=\"primary\" onClick={onMenuToggle}>\n          Управление\n        </Button>\n      </nav>\n      <p>{month.plan}</p>\n      <p>{month.days}</p>\n      <p>{month.ppr}</p>\n      <p>{month.workDays[0]}</p>\n\n    <SwipeableDrawer\n      anchor={'bottom'}\n      open={menuIsOpened}\n      onClose={onCloseMenu}\n      onOpen={onMenuToggle}\n      >\n        <List aria-label=\"menu\">\n          <ListItem button onClick={onNewMonthClick}>\n            <ListItemText className=\"production-page__item-text\" inset primary=\"Новый месяц\" />\n          </ListItem>\n\n          <Divider />\n\n          <ListItem button onClick={onNewWorkDayClick}>\n            <ListItemText className=\"production-page__item-text\" inset primary=\"Новая смена\" />\n          </ListItem>\n\n          <Divider />\n\n          <ListItem button onClick={onChangeWorkkDayClick}>\n            <ListItemText className=\"production-page__item-text\" inset primary=\"Изменить смену\" />\n          </ListItem>\n\n          <Divider />\n\n          <ListItem button onClick={onChangePlanClick}>\n            <ListItemText className=\"production-page__item-text\" inset primary=\"Изменить план\" />\n          </ListItem>\n\n          <Divider />\n\n          <ListItem button onClick={onChangePprClick}>\n            <ListItemText className=\"production-page__item-text\" inset primary=\"Изменить часы ППР\" />\n          </ListItem>\n        </List>\n      </SwipeableDrawer>\n\n      <Dialog open={newMonthMenuOpened} onClose={closeNewMonthMenu}>\n        <NewMonthForm confirmed={onNewMonthConfirmed} canceled={onNewMonthCanceled} product={product} />\n      </Dialog>\n\n      <Dialog open={newWorkDayMenuOpened} onClose={closeNewWorkDayMenu}>\n        <NewWorkDayForm confirmed={onNewWorkDayConfirmed} canceled={onNewWorkDayCanceled}  />\n      </Dialog>\n    </ErrorBoundary>\n    );\n}"]},"metadata":{},"sourceType":"module"}